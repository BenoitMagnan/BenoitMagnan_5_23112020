<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!--LIEN VERS LA POLICE DE CHARACTERES RALEWAY-->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <!---->

  <!--LIEN DE CONNEXION VERS FONTAWESOME-->
  <link rel="preconnect" href="https://fonts.gstatic.com"> 
  <script src="https://kit.fontawesome.com/637b694283.js" crossorigin="anonymous"></script>
  <script src="../javascript/javascript.js"></script>
  <!---->
  

  <link rel="stylesheet" href="../css/style.css" />
  
  <title>Orinoco - Vente en ligne</title>
</head>

<body>
  <div class="bg-primary">
    <div class="container">
      <div class="row">
        <nav class="col navbar navbar-light">
          <a class="navbar-brand" href="../index.html"><img class="mr-4" src="../logo.png"  alt="Logo d'Orinoco - Retour à la page d'acceuil" /></a>
            <ul class="navbar-nav">
              <li class="nav-item ">
                <a class="nav-link" href="panier.html"><i class="fas fa-shopping-basket"></i></a>
              </li>
            </ul>
        </nav>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="flex-row py-2 my-4 bg-primary rounded text-center">
        <div class="col-12">
          <table class="table my-4">
            <thead>
              <h3 class="my-4">Panier</h3>
            </thead>
            <tbody id="productHolder">
              <theader>
                <th>Produit</th>
                <th>Photo</th>
                <th>Modèle</th>
                <th>Quantité</th>
                <th>Prix</th>
                <th>Total</th>
                <th></th>
              </theader>
            </tbody>
          </table>
        </table>
        </div>
    </div>
  </div>
  

  <script>
    const productHolder = document.getElementById('productHolder');
    
    function total (element) {
      const price = element.parentElement.parentElement.parentElement.querySelectorAll("span")[0].innerHTML;
      const total = element.parentElement.parentElement.parentElement.querySelectorAll("span")[1];
      console.log(price);
     }

    
     function removeItem(element) {
      const itemToRemove = element.parentElement.parentElement;
      itemToRemove.remove();
    }

    window.addEventListener('load', () => {
      const items = JSON.parse(localStorage.getItem('items')); 

      for(i = 0; i < items.length; i++) {
        productHolder.innerHTML += "<tr id='" + i + "'>"
        + "<td class='align-middle '>" + items[i].name + "</td>"
        + "<td class='align-middle col-2'>" + "<img class='w-75 rounded shadow'src='" + items[i].imageUrl + "'></td>"
        + "<td class='align-middle'>" + items[i].choice + "</td>"
        + "<td class='align-middle'><form><input onChange=total(this); class='form-control w-50 mx-auto quantity' type='number' min='1' max='100' value='1'></form></td>"
        + "<td class='align-middle'><span>" + items[i].price / 100 + "</span>€</td>"
        + "<td class='align-middle' id='" + items[i].randomId + "'><span></span></td>"
        + "<td class='align-middle'><button class='text-danger removeItem' onclick='removeItem(this);'><i class='fas fa-trash'></i><button></td>"
      + "</tr>"
      ;

      const removeItem = document.getElementsByClassName('removeItem');

      for (let i = 0; i < removeItem.length; i++) {
        removeItem[i].addEventListener("click", function() {
          let items = JSON.parse(localStorage.getItem('items'));
          // console.log(items)
          // console.log(items[i]);
          items.splice(items.indexOf(items[i]), 1);
          localStorage.setItem('items', JSON.stringify(items));
          // console.log(localStorage);
        });
      }

      };
  });
  </script>

</body>
</html>